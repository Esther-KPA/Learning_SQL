.sql

### DISTINCT

Example without DISTINCT :01
SELECT account_id,
       channel,
       COUNT(id) as events
FROM web_events
GROUP BY account_id, channel
ORDER BY account_id, channel DESC

Example with DISTINCT: 02
SELECT DISTINCT account_id,
       channel
FROM web_events
ORDER BY account_id

Exercise 01;;

Use DISTINCT to test if there are any accounts associated with more than one region.

Solution;;
SELECT DISTINCT id, name
FROM accounts;

Without DISTINCT
SELECT a.id as "account id", r.id as "region id", 
a.name as "account name", r.name as "region name"
FROM accounts a
JOIN sales_reps s
ON s.id = a.sales_rep_id
JOIN region r
ON r.id = s.region_id;

Exercise 02;;
Have any sales reps worked on more than one account?

Solution;;
SELECT DISTINCT id, name
FROM sales_reps;

Without DISTINCT 
SELECT s.id, s.name, COUNT(*) num_accounts
FROM accounts a
JOIN sales_reps s
ON s.id = a.sales_rep_id
GROUP BY s.id, s.name
ORDER BY num_accounts;

### HAVING

Example 01;
With aggregations + Having

SELECT account_id,
       SUM(total_amt_usd) AS sum_total_amt_usd
FROM orders
GROUP BY 1
ORDER BY 2 DESC

Without aggregations + Having

SELECT account_id,
       SUM(total_amt_usd) AS sum_total_amt_usd
FROM orders
GROUP BY 1
HAVING SUM(total_amt_usd) >= 250000

Exercise 01;
How many of the sales reps have more than 5 accounts that they manage?

Solution;
